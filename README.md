# PDF_Parser_for_CIIP_Guide_2026

CIIP 상세가이드 PDF에서 항목별 정보를 추출해 CSV로 정리하는 파서입니다. 항목코드, 대/중분류, 점검항목, 점검/조치 내용과 사례를 구조화합니다.

## Features
- PDF 텍스트 추출(PyMuPDF)
- 항목 코드 블록 자동 분리
- 항목별 대분류/중분류/점검항목/중요도/페이지 추출
- 점검 및 조치 사례 분리(타이틀-본문 구조)
- 다중 접두어 자동 감지(U/W/WEB/S 등) 및 문서 순서 보존
- 푸터/페이지 번호 등 잡문 제거
- CSV 저장 및 Excel 친화 정리

## Requirements
- Python 3
- PyMuPDF
- pandas

```bash
pip install pymupdf pandas
```

## Run
```bash
python PDF_Parser_for_CIIP_Guide_2026.py
```

## Output
- CSV 파일
- 주요 컬럼: 대분류, 중분류, 점검항목, 중요도, 항목코드, 페이지, 점검 내용, 점검 목적, 보안 위협, 참고, 대상, 양호/취약 판단, 조치방법, 조치 시 영향, 점검 및 조치 사례

## Notes
- Start 패턴은 `PREFIX-01` + `(상|중|하)` 형태를 기준으로 탐지합니다.
- 점검 및 조치 사례는 `l Apache`, `l Tomcat`, `l 공통` 등 타이틀을 기준으로 분리합니다.
- PDF 내부 푸터/페이지 텍스트가 섞여도 자동 제거합니다.

---

## Version History

### v1.0
- 기본 PDF 텍스트 추출 및 CSV 저장 기능
- 항목 코드 기반 블록 분리 로직 구성
- 메타 정보(대/중분류, 점검항목, 중요도) 초기 파싱

### v1.1
- 점검 및 조치 사례 섹션 분리 기능 추가
- 타이틀 기반 사례(예: `l LINUX`) 추출
- 사례 본문을 다중 케이스로 확장 저장

### v1.2
- 푸터/페이지 번호 제거 로직 추가
- 한국인터넷진흥원/페이지 라인 필터링
- 본문 정리 후 Excel 친화 포맷 적용

### v1.3
- OCR/깨짐 텍스트 허용(‘점검 및 조치 사례’ 감지 완화)
- 대괄호/불릿 타이틀 인식 개선
- 혼합 대소문자 타이틀 인식(Apache, Nginx 등)

### v1.4
- 한글 타이틀 인식(예: `공통`)
- 사례 타이틀 오인 제거(Step 라인 제외)
- 사례 본문 품질 개선

### v1.5
- 다중 접두어 자동 감지(U/W/WEB/S 등)
- 접두어별 누락 방지
- 예외 접두어 스킵 처리

### v2.0
- 문서 등장 순서대로 항목 파싱(정렬 제거)
- 대분류 목차 표기 매핑(`I. Unix 서버` 등)
- 전체 파싱 흐름 안정화
